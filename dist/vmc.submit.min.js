/**
 * Vmc vmcSubmit v1.0.1 Ajax表单提交
 * 维米客网页工作室
 * http://www.vomoc.com/vmc/vmcSubmit/
 * vomoc@qq.com
 * 2017/11/21
 **/
;(function(a,b){a.vmcSubmit=function(){return new c()};var c=function(){this.data={};this.initData={};this.tempData={};this.safeData={};this.fields={};this.success=function(d){};this.failure=function(d){};this.index=0;this.custom=[]};c.prototype.setData=function(d,e){this.data[d]=e};c.prototype.reg=function(d){if(typeof(d.name)!=="string"||d.name===""){throw new Error("未指定字段名")}if(typeof(d.get)!=="function"){throw new Error("未指定取值方法")}if(typeof(d.set)!=="function"){throw new Error("未指定设置方法")}d.group=typeof(d.group)==="string"&&d.group!==""?d.group:"default";d.value=typeof(d.value)==="undefined"?d.get.call(this,d.name):d.value;this.fields[d.name]=d;this.initData[d.name]=d.value};c.prototype._gather=function(e){for(var f in this.fields){var d=this.fields[f];if(e.length<=0||a.inArray(d.group,e)>=0){this.data[f]=d.get.call(this,f)}}};c.prototype._check=function(e){for(var f in this.fields){var d=this.fields[f];if(e.length<=0||a.inArray(d.group,e)>=0){if(typeof(d.rule)==="function"&&false===d.rule.call(this,f,this.data[f])){return false}}}return true};c.prototype.execute=function(){var e=[];for(var d=0;d<arguments.length;d++){if(typeof(arguments[d])==="string"){e.push(arguments[d])}else{if(a.isArray(arguments[d])){a.merge(e,arguments[d])}}}this._gather(e);if(false===this._check(e)){this.stop()}else{this.run()}};c.prototype.extend=function(d){this.custom.push(d)};c.prototype.run=function(){if(this.index>=this.custom.length){this.index=0;this.tempData=a.extend({},this.data);this.safeData=a.extend({},this.initData,this.data);for(var f in this.fields){var e=this.fields[f];e.set.call(this,f,this.safeData[f],this.safeData)}this.success.call(this,this.data)}else{var d=this.index;this.index++;this.custom[d].call(this,this.data)}};c.prototype.stop=function(){this.index=0;this.data=a.extend({},this.tempData);this.failure.call(this,this.data)};c.prototype.reset=function(){var g=[],f=function(){};for(var d=0;d<arguments.length;d++){if(typeof(arguments[d])==="function"){f=arguments[d]}else{if(typeof(arguments[d])==="string"){g.push(arguments[d])}else{if(true===a.isArray(arguments[d])){a.merge(g,arguments[d])}}}}for(var h in this.fields){var e=this.fields[h];if(g.length<=0||a.inArray(e.group,g)>=0){e.set.call(this,h,this.initData[h],this.initData)}}f.call(this)}})(jQuery);